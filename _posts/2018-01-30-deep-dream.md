---
title: "Deep Dream"
date: 2018-01-30
permalink: /posts/2018/01/30/deep-dream
tags: 
  - neural network
  - cnn
  - deep dream
---
<p align="center"><img src="/images/2018-01-30-deep-dream/cover.png" alt="image"></p>

<p align="center">
Image generated by my code
</p>

DeepDream explained (with code in PyTorch)

> Code can be found [here](https://github.com/thesemicolonguy/deep-dream-pytorch).

<!-- ![Image generated by my code](/img/2018-01-30-deep-dream/cover.png) -->

### What is DeepDream?

It is a fun algorithm to generate psychedelic-looking images. It also gives a sense of what features, particular layers of CNNs have learned. It is a way to visualize layers of pre-trained CNNs.

### How does it work?

A base image is used, which is fed to the pre-trained CNN (it can even be random noise). Then, forward pass is done till a particular layer. Now, to get a sense of what that layer has learned, we need to maximize the activations through that layer.

The gradients of that layer are set equal to the activations from that layer, and then gradient ascent is done on the input image. This maximizes the activations of that layer.

However, doing just this much does not produce good images. Various techniques are used to make the resulting image better. Gaussian blurring can be done to make the image smoother.

One main concept in making images better is the use of **octaves**. Input image is repeatedly downscaled, and gradient ascent is applied to all the images, and then the result is merged into a single output image. The following diagram will help get a better understanding of octaves:

<!-- ![Source: [https://www.youtube.com/watch?v=ws-ZbiFV1Ms&t=35s](https://www.youtube.com/watch?v=ws-ZbiFV1Ms&t=35s)](/img/2018-01-30-deep-dream/01.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/01.png" alt="image"></p>

*Source: [https://www.youtube.com/watch?v=ws-ZbiFV1Ms&t=35s](https://www.youtube.com/watch?v=ws-ZbiFV1Ms&t=35s)*

### Code?

I used VGG16 to create these DeepDream visualizations.

The code has mainly two functions :

* dd_helper : This is the actual deep_dream code. It takes an input image, makes a forward pass till a particular layer, and then updates the input image by gradient ascent.

<script src="https://gist.github.com/sar-gupta/db81a5e857c275911d5ed95405e2d43d.js"></script>

* deep_dream_vgg : This is a** recursive** function. It repeatedly downscales the image, then calls dd_helper. Then it upscales the result, and merges (blends) it to the image at one level higher on the recursive tree. The final image is the same size as the input image.

<script src="https://gist.github.com/sar-gupta/6bc985b10d6f4cdc310fa844a9adbfa3.js"></script>

## Output at various conv layers (from shallow to deeper layers):

<!-- ![Input image](/img/2018-01-30-deep-dream/02.png)*Input image* -->
<p align="center"><img src="/images/2018-01-30-deep-dream/02.png" alt="image"></p>
<p align="center">Input image</p>

> Notice that the shallow layers learn basic shapes, lines, edges. After that, layers learn patterns. And the deeper layers learn much more complex features like eyes, face, etc.

<!-- ![](/img/2018-01-30-deep-dream/03.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/03.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/04.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/04.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/05.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/05.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/06.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/06.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/07.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/07.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/08.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/08.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/09.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/09.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/10.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/10.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/11.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/11.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/12.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/12.png" alt="image"></p>

<!-- ![](/img/2018-01-30-deep-dream/13.png) -->
<p align="center"><img src="/images/2018-01-30-deep-dream/13.png" alt="image"></p>
